import { Button, VerticalBox, HorizontalBox, ListView, LineEdit, StandardListView, GroupBox, CheckBox, ComboBox } from "std-widgets.slint";

export struct FileEntry {
    name: string,
    size: string,
    modified: string,
    is_dir: bool,
}

export struct MonitoringEvent {
    event_type: string,
    path: string,
    timestamp: string,
}

export component MainWindow inherits Window {
    title: "FVRS - File System Monitoring Tool";
    preferred-width: 800px;
    preferred-height: 600px;

    in property <[FileEntry]> files: [];
    in property <[MonitoringEvent]> events: [];
    in property <string> current_path: "";
    in property <bool> monitoring_active: false;

    callback start_monitoring();
    callback stop_monitoring();
    callback change_directory(string);
    callback refresh_files();

    VerticalBox {
        padding: 10px;
        spacing: 10px;

        // ツールバー
        HorizontalBox {
            spacing: 10px;
            height: 40px;

            LineEdit {
                text: current_path;
                placeholder-text: "Enter directory path...";
                accepted => {
                    change_directory(self.text);
                }
            }

            Button {
                text: "Browse";
                max-width: 80px;
                clicked => {
                    refresh_files();
                }
            }

            Rectangle { width: 20px; } // スペーサー

            Button {
                text: monitoring_active ? "Stop Monitoring" : "Start Monitoring";
                min-width: 120px;
                clicked => {
                    if (monitoring_active) {
                        stop_monitoring();
                    } else {
                        start_monitoring();
                    }
                }
            }
        }

        // メインコンテンツエリア
        HorizontalBox {
            spacing: 10px;

            // ファイル一覧
            GroupBox {
                title: "Files";
                preferred-width: 400px;

                StandardListView {
                    model: files;
                }
            }

            // 監視イベント一覧
            GroupBox {
                title: "Monitoring Events";
                preferred-width: 400px;

                ListView {
                    for event in events: Rectangle {
                        height: 60px;
                        border-width: 1px;
                        border-color: #e0e0e0;

                        VerticalBox {
                            padding: 5px;
                            spacing: 2px;

                            Text {
                                text: event.event_type + ": " + event.path;
                                font-weight: bold;
                                font-size: 12px;
                            }

                            Text {
                                text: event.timestamp;
                                font-size: 10px;
                                color: #666;
                            }
                        }
                    }
                }
            }
        }

        // ステータスバー
        HorizontalBox {
            height: 30px;
            padding: 5px;
            background: #f0f0f0;

            Text {
                text: "Ready | Files: " + files.length + " | Events: " + events.length;
                vertical-alignment: center;
            }

            Rectangle { } // スペーサー

            Text {
                text: monitoring_active ? "● Monitoring Active" : "○ Monitoring Stopped";
                color: monitoring_active ? #00aa00 : #aa0000;
                vertical-alignment: center;
            }
        }
    }
} 